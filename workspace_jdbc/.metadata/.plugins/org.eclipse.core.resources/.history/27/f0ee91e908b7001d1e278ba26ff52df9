package dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;

import dto.MembersDTO;

public class MembersDAO {
//	private Connection con;
//	private Statement stat;
	private String url = "jdbc:oracle:thin:@localhost:1521:xe";
	private String dbID = "kh";
	private String dbPW = "kh";
	
	public MembersDAO() throws Exception {
		super();
		Class.forName("oracle.jdbc.driver.OracleDriver");
	}
	
	public MembersDAO(String url, String dbID, String dbPW) throws Exception {
		super();
		Class.forName("oracle.jdbc.driver.OracleDriver");
		this.url = url;
		this.dbID = dbID;
		this.dbPW = dbPW;
	}
	
	private Connection createConnection() throws Exception {
		return DriverManager.getConnection(url, dbPW, dbID);
	}
	
	public int insert(MembersDTO dto) throws Exception{
		int result = 0;
		try( 	Connection con = this.createConnection();
				Statement stat = con.createStatement(); ){
			String sql = 
					"insert into MEMBERS(ID, PW, NAME, CONTACT)"
					+" values('"+ dto.getId() +"',"
					+"'"+dto.getPw()+"',"
					+"'"+dto.getName()+"',"
					+"'"+dto.getContact()+"')";
			result = stat.executeUpdate(sql);
			con.commit();
		}
		return result;
	}
}
