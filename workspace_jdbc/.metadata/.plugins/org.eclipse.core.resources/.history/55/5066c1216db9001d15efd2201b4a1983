package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;

import org.apache.commons.dbcp2.BasicDataSource;

import dto.MembersDTO;

public class MembersDAO {
	private String url = "jdbc:oracle:thin:@localhost:1521:xe";
	private String dbID = "board";
	private String dbPW = "board";
	private final BasicDataSource bds = new BasicDataSource();
	private final int poolSize = 5;
	
	public MembersDAO(){
		super();
		this.init();
	}
	
	
	public MembersDAO(String url, String dbID, String dbPW){
		super();
		this.url = url;
		this.dbID = dbID;
		this.dbPW = dbPW;
		this.init();
	}

	private void init() {
		bds.setUrl(url);
		bds.setUsername(dbID);
		bds.setPassword(dbPW);
		bds.setInitialSize(poolSize);
	}
	
	public int insert(MembersDTO dto) throws Exception{
		String sql = "insert into MEMBERS(ID,PW,NAME,CONTACT) values(?,?,?,?)";
		try(	Connection con = this.bds.getConnection();
				PreparedStatement pstat = con.prepareStatement(sql);){
			pstat.setString(1, dto.getId());
			pstat.setString(2,  dto.getPw());
			pstat.setString(3, dto.getName());
			pstat.setString(4, dto.getContact());
			int result = pstat.executeUpdate();
			con.commit();
			return result;
		}
	}
}
